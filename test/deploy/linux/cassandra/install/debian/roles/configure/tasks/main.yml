---
- debug:
    msg: Install Cassandra

- name: Get latest packages info
  shell: "apt-get update -y"
  become: true

- name: Run Cassandra
  shell: "systemctl start cassandra"
  become: true

- name: Allow to create user
  command: |
    cd /etc/cassandra/
    sudo sed -i 's/authenticator: AllowAllAuthenticator/authenticator: PasswordAuthenticator/g' cassandra.yaml
  become: true

- name: Restart cassandra
  command: |
    nodetool flush system
    systemctl restart cassandra
  become: true

- name: Create user
  command: |
    cqlsh localhost -u cassandra -p cassandra -e "CREATE USER test WITH PASSWORD 'test';"
  become: true
