---
- debug:
    msg: Install MySQL

- name: Install APT extras
  apt:
    name: ['dirmngr', 'debconf']
    update_cache: yes
    state: latest
  become: yes

- name: Add official MySQL package authentication key
  apt_key:
    keyserver: pool.sks-keyservers.net
    id: 5072E1F5
    state: present
  become: yes

- name: Add MySQL repository
  apt_repository:
    repo: deb http://repo.mysql.com/apt/debian/ stretch mysql-8.0
    filename: mysql80
    state: present
  become: yes

- name: Install/Update MySQL 8.0 Community Server
  apt:
    name: ['mysql-server']
    update_cache: yes
    state: latest
  environment:
    DEBIAN_FRONTEND: noninteractive
  become: yes

- name: Restart MySQL
  shell: "systemctl restart mysqld"
  become: yes
