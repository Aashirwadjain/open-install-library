---
- debug:
    msg: Install MySQL

- name: Get latest packages info
  shell: "apt update"
  become: yes

- name: Install gnupg
  shell: "apt install gnupg"
  become: yes

- name: Download mysql .deb package
  shell: "cd /tmp | wget https://dev.mysql.com/get/mysql-apt-config_0.8.13-1_all.deb"

- name: Install mysql .deb package
  shell: "dkpg -i mysql-apt-config*"
  become: yes

- name: Get latest packages info
  shell: "apt update"
  become: yes
  
- name: Install MySQL
  shell: "apt install mysql-server -y"
  become: yes

- name: Check if default DB exists
  shell: "mysql -e 'SHOW DATABASES;' | grep 'mysql'"
  register: dbstatus
  failed_when: dbstatus.rc == 1 ## fail when no such database exists

- name: Restart MySQL
  shell: "systemctl restart mysql"
  become: yes
